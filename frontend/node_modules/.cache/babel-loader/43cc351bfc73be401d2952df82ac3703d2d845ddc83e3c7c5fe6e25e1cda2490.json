{"ast":null,"code":"import React,{useContext,useEffect,useRef,useState}from\"react\";import MenuItem from\"@material-ui/core/MenuItem\";import Menu from\"@material-ui/core/Menu\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import ConfirmationModal from\"../ConfirmationModal\";import TransferTicketModalCustom from\"../TransferTicketModalCustom\";import toastError from\"../../errors/toastError\";import{Can}from\"../Can\";import{AuthContext}from\"../../context/Auth/AuthContext\";import ScheduleModal from\"../ScheduleModal\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const TicketOptionsMenu=_ref=>{let{ticket,menuOpen,handleClose,anchorEl}=_ref;const[confirmationOpen,setConfirmationOpen]=useState(false);const[transferTicketModalOpen,setTransferTicketModalOpen]=useState(false);const isMounted=useRef(true);const{user}=useContext(AuthContext);const[scheduleModalOpen,setScheduleModalOpen]=useState(false);const[contactId,setContactId]=useState(null);useEffect(()=>{return()=>{isMounted.current=false;};},[]);const handleDeleteTicket=async()=>{try{await api.delete(\"/tickets/\".concat(ticket.id));}catch(err){toastError(err);}};const handleOpenConfirmationModal=e=>{setConfirmationOpen(true);handleClose();};const handleOpenTransferModal=e=>{setTransferTicketModalOpen(true);handleClose();};const handleCloseTransferTicketModal=()=>{if(isMounted.current){setTransferTicketModalOpen(false);}};const handleOpenScheduleModal=()=>{handleClose();setContactId(ticket.contact.id);setScheduleModalOpen(true);};const handleCloseScheduleModal=()=>{setScheduleModalOpen(false);setContactId(null);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},keepMounted:true,transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleClose,children:[/*#__PURE__*/_jsx(MenuItem,{onClick:handleOpenScheduleModal,children:i18n.t(\"ticketOptionsMenu.schedule\")}),/*#__PURE__*/_jsx(MenuItem,{onClick:handleOpenTransferModal,children:i18n.t(\"ticketOptionsMenu.transfer\")}),/*#__PURE__*/_jsx(Can,{role:user.profile,perform:\"ticket-options:deleteTicket\",yes:()=>/*#__PURE__*/_jsx(MenuItem,{onClick:handleOpenConfirmationModal,children:i18n.t(\"ticketOptionsMenu.delete\")})})]}),/*#__PURE__*/_jsx(ConfirmationModal,{title:\"\".concat(i18n.t(\"ticketOptionsMenu.confirmationModal.title\")).concat(ticket.id,\" \").concat(i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\"),\" \").concat(ticket.contact.name,\"?\"),open:confirmationOpen,onClose:setConfirmationOpen,onConfirm:handleDeleteTicket,children:i18n.t(\"ticketOptionsMenu.confirmationModal.message\")}),/*#__PURE__*/_jsx(TransferTicketModalCustom,{modalOpen:transferTicketModalOpen,onClose:handleCloseTransferTicketModal,ticketid:ticket.id}),/*#__PURE__*/_jsx(ScheduleModal,{open:scheduleModalOpen,onClose:handleCloseScheduleModal,\"aria-labelledby\":\"form-dialog-title\",contactId:contactId})]});};export default TicketOptionsMenu;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}