{"ast":null,"code":"import React,{useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{makeStyles,createTheme,ThemeProvider}from\"@material-ui/core/styles\";import{IconButton}from\"@material-ui/core\";import{MoreVert,Replay}from\"@material-ui/icons\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import TicketOptionsMenu from\"../TicketOptionsMenu\";import ButtonWithSpinner from\"../ButtonWithSpinner\";import toastError from\"../../errors/toastError\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{TicketsContext}from\"../../context/Tickets/TicketsContext\";import CheckCircleIcon from'@material-ui/icons/CheckCircle';import UndoRoundedIcon from'@material-ui/icons/UndoRounded';import Tooltip from'@material-ui/core/Tooltip';import{green}from'@material-ui/core/colors';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({actionButtons:{marginRight:6,flex:\"none\",alignSelf:\"center\",marginLeft:\"auto\",\"& > *\":{margin:theme.spacing(0.5)}}}));const TicketActionButtonsCustom=_ref=>{let{ticket}=_ref;const classes=useStyles();const history=useHistory();const[anchorEl,setAnchorEl]=useState(null);const[loading,setLoading]=useState(false);const ticketOptionsMenuOpen=Boolean(anchorEl);const{user}=useContext(AuthContext);const{setCurrentTicket}=useContext(TicketsContext);const customTheme=createTheme({palette:{primary:green}});const handleOpenTicketOptionsMenu=e=>{setAnchorEl(e.currentTarget);};const handleCloseTicketOptionsMenu=e=>{setAnchorEl(null);};const handleUpdateTicketStatus=async(e,status,userId)=>{setLoading(true);try{await api.put(\"/tickets/\".concat(ticket.id),{status:status,userId:userId||null});setLoading(false);if(status===\"open\"){setCurrentTicket({...ticket,code:\"#open\"});}else{setCurrentTicket({id:null,code:null});history.push(\"/tickets\");}}catch(err){setLoading(false);toastError(err);}};return/*#__PURE__*/_jsxs(\"div\",{className:classes.actionButtons,children:[ticket.status===\"closed\"&&/*#__PURE__*/_jsx(ButtonWithSpinner,{loading:loading,startIcon:/*#__PURE__*/_jsx(Replay,{}),size:\"small\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id),children:i18n.t(\"messagesList.header.buttons.reopen\")}),ticket.status===\"open\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tooltip,{title:i18n.t(\"messagesList.header.buttons.return\"),children:/*#__PURE__*/_jsx(IconButton,{onClick:e=>handleUpdateTicketStatus(e,\"pending\",null),children:/*#__PURE__*/_jsx(UndoRoundedIcon,{})})}),/*#__PURE__*/_jsx(ThemeProvider,{theme:customTheme,children:/*#__PURE__*/_jsx(Tooltip,{title:i18n.t(\"messagesList.header.buttons.resolve\"),children:/*#__PURE__*/_jsx(IconButton,{onClick:e=>handleUpdateTicketStatus(e,\"closed\",user===null||user===void 0?void 0:user.id),color:\"primary\",children:/*#__PURE__*/_jsx(CheckCircleIcon,{})})})}),/*#__PURE__*/_jsx(IconButton,{onClick:handleOpenTicketOptionsMenu,children:/*#__PURE__*/_jsx(MoreVert,{})}),/*#__PURE__*/_jsx(TicketOptionsMenu,{ticket:ticket,anchorEl:anchorEl,menuOpen:ticketOptionsMenuOpen,handleClose:handleCloseTicketOptionsMenu})]}),ticket.status===\"pending\"&&/*#__PURE__*/_jsx(ButtonWithSpinner,{loading:loading,size:\"small\",variant:\"contained\",color:\"primary\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id),children:i18n.t(\"messagesList.header.buttons.accept\")})]});};export default TicketActionButtonsCustom;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}