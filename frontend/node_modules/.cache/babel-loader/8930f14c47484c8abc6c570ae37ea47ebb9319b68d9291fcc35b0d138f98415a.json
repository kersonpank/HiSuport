{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import QRCode from\"qrcode.react\";import toastError from\"../../errors/toastError\";import{Dialog,DialogContent,Paper,Typography}from\"@material-ui/core\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import{socketConnection}from\"../../services/socket\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const QrcodeModal=_ref=>{let{open,onClose,whatsAppId}=_ref;const[qrCode,setQrCode]=useState(\"\");useEffect(()=>{const fetchSession=async()=>{if(!whatsAppId)return;try{const{data}=await api.get(\"/whatsapp/\".concat(whatsAppId));setQrCode(data.qrcode);}catch(err){toastError(err);}};fetchSession();},[whatsAppId]);useEffect(()=>{if(!whatsAppId)return;const companyId=localStorage.getItem(\"companyId\");const socket=socketConnection({companyId});socket.on(\"company-\".concat(companyId,\"-whatsappSession\"),data=>{if(data.action===\"update\"&&data.session.id===whatsAppId){setQrCode(data.session.qrcode);}if(data.action===\"update\"&&data.session.qrcode===\"\"){onClose();}});return()=>{socket.disconnect();};},[whatsAppId,onClose]);return/*#__PURE__*/_jsx(Dialog,{open:open,onClose:onClose,maxWidth:\"lg\",scroll:\"paper\",children:/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Paper,{elevation:0,children:[/*#__PURE__*/_jsx(Typography,{color:\"primary\",gutterBottom:true,children:i18n.t(\"qrCode.message\")}),qrCode?/*#__PURE__*/_jsx(QRCode,{value:qrCode,size:256}):/*#__PURE__*/_jsx(\"span\",{children:\"Waiting for QR Code\"})]})})});};export default/*#__PURE__*/React.memo(QrcodeModal);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}